<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Session 2 | Energy-Transitions ‚Äî Class 2</title>
<meta name="author" content="Renan Magalh√£es">
<meta name="description" content="1. Why Data Cleaning Is the Hardest (and Most Important) Step  When researchers talk about ‚Äúanalysis,‚Äù they often imagine fancy models and colorful plots. In reality, most of the work happens...">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="Session 2 | Energy-Transitions ‚Äî Class 2">
<meta property="og:type" content="book">
<meta property="og:description" content="1. Why Data Cleaning Is the Hardest (and Most Important) Step  When researchers talk about ‚Äúanalysis,‚Äù they often imagine fancy models and colorful plots. In reality, most of the work happens...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Session 2 | Energy-Transitions ‚Äî Class 2">
<meta name="twitter:description" content="1. Why Data Cleaning Is the Hardest (and Most Important) Step  When researchers talk about ‚Äúanalysis,‚Äù they often imagine fancy models and colorful plots. In reality, most of the work happens...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Custom header additions --><meta name="viewport" content="width=device-width, initial-scale=1">
<style>
      #corner-logo {
        position: fixed;
        top: 12px;
        right: 12px;
        z-index: 1030; /* above navbar */
      }
      #corner-logo img {
        height: 36px;
        opacity: 0.95;
      }
      #corner-logo img:hover {
        opacity: 1;
      }
      @media (max-width: 991px){
        #corner-logo { top: 8px; right: 8px; }
        #corner-logo img { height: 28px; }
      }
    </style>
<script>
      document.addEventListener("DOMContentLoaded", function () {
        var div = document.createElement("div");
        div.id = "corner-logo";
        div.innerHTML = '<img src="assets/logo1.png" alt="Logo">';
        document.body.appendChild(div);
      });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Energy-Transitions</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="syllabus.html">Syllabus</a></li>
<li><a class="" href="session-1.html">Session 1</a></li>
<li><a class="active" href="session-2.html">Session 2</a></li>
<li><a class="" href="session-3.html">Session 3</a></li>
<li><a class="" href="session-4.html">Session 4</a></li>
<li><a class="" href="session-5.html">Session 5</a></li>
<li><a class="" href="assignments-uploads.html">Assignments &amp; Uploads</a></li>
<li><a class="" href="datasets.html">Datasets</a></li>
<li><a class="" href="about-publishing.html">About &amp; Publishing</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/USER/REPO">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="session-2" class="section level1 unnumbered">
<h1>Session 2<a class="anchor" aria-label="anchor" href="#session-2"><i class="fas fa-link"></i></a>
</h1>
<hr>
<div id="why-data-cleaning-is-the-hardest-and-most-important-step" class="section level2 unnumbered">
<h2>1. Why Data Cleaning Is the Hardest (and Most Important) Step<a class="anchor" aria-label="anchor" href="#why-data-cleaning-is-the-hardest-and-most-important-step"><i class="fas fa-link"></i></a>
</h2>
<iframe src="https://drive.google.com/file/d/1Y1CQ4xJTW3xfPGJFA0hOHpBUM7Fj_UPc/preview" width="640" height="360" allow="autoplay">
</iframe>
<p>When researchers talk about ‚Äúanalysis,‚Äù they often imagine fancy models and colorful plots.
In reality, most of the work happens before any model is fitted: cleaning, organizing, and validating the raw data. Raw data are almost never ready for analysis. Surveys come back with extra spaces, numbers formatted as text, spelling variations, and missing responses.
If you skip the cleaning stage, every later step‚Äîsummary statistics, regression, visualization‚Äîwill quietly give misleading results.</p>
<p><strong>What ‚Äútidy‚Äù means</strong></p>
<p>Hadley Wickham defines tidy data as having three rules:</p>
<p><em>1.</em>Each variable forms a column.
<em>2.</em>Each observation forms a row.
<em>3.</em>Each value forms a single cell.</p>
<p>Once data satisfy these rules, they can easily be filtered, summarized, plotted, and joined.
Most R packages (especially those in the tidyverse) assume data are tidy.
The cleaning workflow we‚Äôll follow mirrors the professional pipeline:</p>
<pre><code>## Warning: package 'gt' was built under R version 4.5.1</code></pre>
<div id="ljmhfarvyc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ljmhfarvyc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ljmhfarvyc thead, #ljmhfarvyc tbody, #ljmhfarvyc tfoot, #ljmhfarvyc tr, #ljmhfarvyc td, #ljmhfarvyc th {
  border-style: none;
}

#ljmhfarvyc p {
  margin: 0;
  padding: 0;
}

#ljmhfarvyc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ljmhfarvyc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ljmhfarvyc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ljmhfarvyc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ljmhfarvyc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ljmhfarvyc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ljmhfarvyc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ljmhfarvyc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ljmhfarvyc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ljmhfarvyc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ljmhfarvyc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ljmhfarvyc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ljmhfarvyc .gt_spanner_row {
  border-bottom-style: hidden;
}

#ljmhfarvyc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ljmhfarvyc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ljmhfarvyc .gt_from_md > :first-child {
  margin-top: 0;
}

#ljmhfarvyc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ljmhfarvyc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ljmhfarvyc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmhfarvyc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ljmhfarvyc .gt_row_group_first td {
  border-top-width: 2px;
}

#ljmhfarvyc .gt_row_group_first th {
  border-top-width: 2px;
}

#ljmhfarvyc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmhfarvyc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ljmhfarvyc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ljmhfarvyc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ljmhfarvyc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmhfarvyc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ljmhfarvyc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ljmhfarvyc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ljmhfarvyc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ljmhfarvyc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ljmhfarvyc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmhfarvyc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ljmhfarvyc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmhfarvyc .gt_left {
  text-align: left;
}

#ljmhfarvyc .gt_center {
  text-align: center;
}

#ljmhfarvyc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ljmhfarvyc .gt_font_normal {
  font-weight: normal;
}

#ljmhfarvyc .gt_font_bold {
  font-weight: bold;
}

#ljmhfarvyc .gt_font_italic {
  font-style: italic;
}

#ljmhfarvyc .gt_super {
  font-size: 65%;
}

#ljmhfarvyc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ljmhfarvyc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ljmhfarvyc .gt_indent_1 {
  text-indent: 5px;
}

#ljmhfarvyc .gt_indent_2 {
  text-indent: 10px;
}

#ljmhfarvyc .gt_indent_3 {
  text-indent: 15px;
}

#ljmhfarvyc .gt_indent_4 {
  text-indent: 20px;
}

#ljmhfarvyc .gt_indent_5 {
  text-indent: 25px;
}

#ljmhfarvyc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ljmhfarvyc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div class="inline-table"><table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Data Cleaning Workflow in R</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Step">Step</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Goal">Goal</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Example_Functions">Example Functions</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Step" class="gt_row gt_left"><span class="gt_from_md">Import</span></td>
<td headers="Goal" class="gt_row gt_left"><span class="gt_from_md">Load raw data reliably</span></td>
<td headers="Example_Functions" class="gt_row gt_left"><span class="gt_from_md">read_csv()</span></td>
</tr>
<tr>
<td headers="Step" class="gt_row gt_left"><span class="gt_from_md">Inspect</span></td>
<td headers="Goal" class="gt_row gt_left"><span class="gt_from_md">Understand structure</span></td>
<td headers="Example_Functions" class="gt_row gt_left"><span class="gt_from_md">glimpse(), summary()</span></td>
</tr>
<tr>
<td headers="Step" class="gt_row gt_left"><span class="gt_from_md">Clean names/types</span></td>
<td headers="Goal" class="gt_row gt_left"><span class="gt_from_md">Make columns usable</span></td>
<td headers="Example_Functions" class="gt_row gt_left"><span class="gt_from_md">janitor::clean_names(), mutate()</span></td>
</tr>
<tr>
<td headers="Step" class="gt_row gt_left"><span class="gt_from_md">Handle missingness</span></td>
<td headers="Goal" class="gt_row gt_left"><span class="gt_from_md">Make absence explicit</span></td>
<td headers="Example_Functions" class="gt_row gt_left"><span class="gt_from_md">is.na(), if_else()</span></td>
</tr>
<tr>
<td headers="Step" class="gt_row gt_left"><span class="gt_from_md">Recode</span></td>
<td headers="Goal" class="gt_row gt_left"><span class="gt_from_md">Create consistent categories</span></td>
<td headers="Example_Functions" class="gt_row gt_left"><span class="gt_from_md">case_when(), fct_recode()</span></td>
</tr>
<tr>
<td headers="Step" class="gt_row gt_left"><span class="gt_from_md">Verify visually</span></td>
<td headers="Goal" class="gt_row gt_left"><span class="gt_from_md">Sanity-check patterns</span></td>
<td headers="Example_Functions" class="gt_row gt_left"><span class="gt_from_md">ggplot()</span></td>
</tr>
<tr>
<td headers="Step" class="gt_row gt_left"><span class="gt_from_md">Save</span></td>
<td headers="Goal" class="gt_row gt_left"><span class="gt_from_md">Freeze a clean version</span></td>
<td headers="Example_Functions" class="gt_row gt_left"><span class="gt_from_md">write_csv()</span></td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="importing-and-inspecting-the-dataset" class="section level2 unnumbered">
<h2>2. Importing and Inspecting the Dataset<a class="anchor" aria-label="anchor" href="#importing-and-inspecting-the-dataset"><i class="fas fa-link"></i></a>
</h2>
<p>We‚Äôll use the same FinSESCo survey introduced in Session 1.
This time we‚Äôll pay close attention to its structure, not yet to its content.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="va">finsesco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"finsesco_dirt.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>How R reads files</strong></p>
<p><code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> (from readr) is faster and safer than base R‚Äôs <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code>:</p>
<ul>
<li>It assumes UTF-8 encoding (so German umlauts, ‚Ç¨ signs, etc. remain intact).</li>
<li>It guesses data types by scanning a sample of rows.</li>
<li>It reports parsing problems instead of silently converting to text.</li>
</ul>
<p><code><a href="https://here.r-lib.org/reference/here.html">here::here()</a></code> constructs file paths relative to your R Project root, which makes your script portable between computers and operating systems.</p>
<p>Now look inside:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">finsesco</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 299
## Columns: 34
## $ id                 &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20‚Ä¶
## $ income_range       &lt;chr&gt; "Low", "Low", "High", "Medium", "Low", "High", "Low", "Low", "High", ‚Ä¶
## $ co_ownership       &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶
## $ ownership          &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, ‚Ä¶
## $ index_1            &lt;dbl&gt; 4.4, 5.0, 3.4, 5.0, 3.6, 5.0, 5.0, 3.6, 4.2, 3.0, 3.0, 5.0, 5.0, 5.0,‚Ä¶
## $ index_2            &lt;dbl&gt; 3.571429, 5.000000, 3.714286, 5.000000, 3.000000, 3.857143, NA, 4.142‚Ä¶
## $ index_3            &lt;dbl&gt; 4, 5, 2, 5, NA, 3, NA, 3, 5, 1, 1, 5, 4, 4, 3, 2, 5, 5, 3, 5, 3, 3, 1‚Ä¶
## $ index_4            &lt;dbl&gt; 3, 5, 3, 5, NA, 1, NA, 4, 4, 1, 1, 5, 5, 5, 4, 4, 5, NA, 2, 5, 4, 2, ‚Ä¶
## $ index_5            &lt;dbl&gt; 4, 4, 5, 1, NA, 3, NA, 4, 2, 1, 1, 4, 4, 5, 3, 4, 1, 5, 5, 5, 3, 2, 5‚Ä¶
## $ index_6            &lt;dbl&gt; 4.333333, 4.666667, 3.000000, 3.000000, NA, 3.666667, NA, 4.666667, 3‚Ä¶
## $ gender             &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, ‚Ä¶
## $ age                &lt;dbl&gt; 21.5, 63.0, 21.5, 58.0, 63.0, 53.0, 53.0, 63.0, 53.0, 63.0, 38.0, 53.‚Ä¶
## $ age_factor         &lt;chr&gt; "18-25", "61-65", "18-25", "56-60", "61-65", "51-55", "51-55", "61-65‚Ä¶
## $ academic           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, ‚Ä¶
## $ income_group       &lt;chr&gt; "Low", "Low", "High", "Medium", "Low", "High", "Low", "Low", "High", ‚Ä¶
## $ use_finsesco       &lt;dbl&gt; 1, 4, 2, 1, NA, 1, NA, 1, 1, 1, NA, 1, 1, NA, 1, 1, 1, NA, 1, NA, 1, ‚Ä¶
## $ index_finsesco     &lt;dbl&gt; 0.7299988, 1.1276756, 0.9498817, 0.7299988, NA, 0.7299988, NA, 0.7299‚Ä¶
## $ p_flat             &lt;dbl&gt; 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, ‚Ä¶
## $ p_apartment        &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, ‚Ä¶
## $ p_house            &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, ‚Ä¶
## $ home_ownership     &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, ‚Ä¶
## $ finsesco_familiar  &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶
## $ crowd_yes          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, ‚Ä¶
## $ crowd_own          &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, ‚Ä¶
## $ income_low         &lt;dbl&gt; 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, ‚Ä¶
## $ income_med         &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, ‚Ä¶
## $ income_high        &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, ‚Ä¶
## $ prosumership       &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, ‚Ä¶
## $ social_benefit     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶
## $ control            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶
## $ interact           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ‚Ä¶
## $ monitor            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, ‚Ä¶
## $ `Income Range`     &lt;dbl&gt; 1143.789, 1394.153, 4948.919, NA, 1470.234, 5273.978, 1264.053, 1446.‚Ä¶
## $ `Income Range (‚Ç¨)` &lt;dbl&gt; 1143.789, 1394.153, 4948.919, NA, 1470.234, 5273.978, 1264.053, 1446.‚Ä¶</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">finsesco</span><span class="op">)</span></span></code></pre></div>
<pre><code>##        id        income_range        co_ownership      ownership        index_1     
##  Min.   :  1.0   Length:299         Min.   :0.0000   Min.   :0.000   Min.   :1.000  
##  1st Qu.: 75.5   Class :character   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:4.000  
##  Median :150.0   Mode  :character   Median :0.0000   Median :0.000   Median :4.400  
##  Mean   :150.0                      Mean   :0.1104   Mean   :0.194   Mean   :4.281  
##  3rd Qu.:224.5                      3rd Qu.:0.0000   3rd Qu.:0.000   3rd Qu.:5.000  
##  Max.   :299.0                      Max.   :1.0000   Max.   :1.000   Max.   :5.000  
##                                                                                     
##     index_2         index_3         index_4         index_5         index_6          gender      
##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :0.0000  
##  1st Qu.:3.286   1st Qu.:3.000   1st Qu.:2.000   1st Qu.:3.000   1st Qu.:2.500   1st Qu.:0.0000  
##  Median :3.857   Median :4.000   Median :3.000   Median :4.000   Median :3.333   Median :0.0000  
##  Mean   :3.752   Mean   :3.503   Mean   :3.217   Mean   :3.515   Mean   :3.249   Mean   :0.4983  
##  3rd Qu.:4.286   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:5.000   3rd Qu.:4.333   3rd Qu.:1.0000  
##  Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :5.000   Max.   :1.0000  
##  NA's   :3       NA's   :5       NA's   :23      NA's   :6       NA's   :6                       
##       age         age_factor           academic     income_group        use_finsesco  
##  Min.   :21.50   Length:299         Min.   :0.000   Length:299         Min.   :1.000  
##  1st Qu.:43.00   Class :character   1st Qu.:0.000   Class :character   1st Qu.:1.000  
##  Median :53.00   Mode  :character   Median :0.000   Mode  :character   Median :1.000  
##  Mean   :51.63                      Mean   :0.311                      Mean   :1.539  
##  3rd Qu.:63.00                      3rd Qu.:1.000                      3rd Qu.:2.000  
##  Max.   :68.00                      Max.   :1.000                      Max.   :4.000  
##                                                                        NA's   :82     
##  index_finsesco       p_flat        p_apartment        p_house       home_ownership 
##  Min.   :0.7300   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.000  
##  1st Qu.:0.7300   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.000  
##  Median :0.7300   Median :0.0000   Median :0.0000   Median :0.0000   Median :0.000  
##  Mean   :0.8187   Mean   :0.4448   Mean   :0.2241   Mean   :0.3177   Mean   :0.404  
##  3rd Qu.:0.9499   3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:1.000  
##  Max.   :1.1277   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.000  
##  NA's   :82                                                          NA's   :2      
##  finsesco_familiar   crowd_yes         crowd_own       income_low       income_med    
##  Min.   :0.00000   Min.   :0.00000   Min.   :0.000   Min.   :0.0000   Min.   :0.0000  
##  1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.000   1st Qu.:0.0000   1st Qu.:0.0000  
##  Median :0.00000   Median :0.00000   Median :0.000   Median :0.0000   Median :0.0000  
##  Mean   :0.05724   Mean   :0.01684   Mean   :0.138   Mean   :0.2843   Mean   :0.3411  
##  3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.000   3rd Qu.:1.0000   3rd Qu.:1.0000  
##  Max.   :1.00000   Max.   :1.00000   Max.   :1.000   Max.   :1.0000   Max.   :1.0000  
##  NA's   :2         NA's   :2         NA's   :2                                        
##   income_high      prosumership   social_benefit      control          interact    
##  Min.   :0.0000   Min.   :0.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.000  
##  1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.000  
##  Median :0.0000   Median :0.000   Median :0.0000   Median :0.0000   Median :0.000  
##  Mean   :0.2508   Mean   :0.194   Mean   :0.1137   Mean   :0.1137   Mean   :0.107  
##  3rd Qu.:0.5000   3rd Qu.:0.000   3rd Qu.:0.0000   3rd Qu.:0.0000   3rd Qu.:0.000  
##  Max.   :1.0000   Max.   :1.000   Max.   :1.0000   Max.   :1.0000   Max.   :1.000  
##                                                                                    
##     monitor        Income Range  Income Range (‚Ç¨)
##  Min.   :0.0000   Min.   :1005   Min.   :1005    
##  1st Qu.:0.0000   1st Qu.:1236   1st Qu.:1236    
##  Median :0.0000   Median :1481   Median :1481    
##  Mean   :0.1338   Mean   :3443   Mean   :3443    
##  3rd Qu.:0.0000   3rd Qu.:5710   3rd Qu.:5710    
##  Max.   :1.0000   Max.   :7980   Max.   :7980    
##                   NA's   :139    NA's   :139</code></pre>
<p><code><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse()</a></code> prints one line per variable, showing type and first values; <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> gives numeric summaries or category counts.</p>
<p>Rows: 2,585
Columns: 45
$ Age <chr> ‚Äú32‚Äù, ‚Äú45‚Äù, ‚Äú63‚Äù, ‚Äú28‚Äù, ‚Ä¶
$ Income Range (‚Ç¨) <chr> ‚Äú2,500‚Äì4,000‚Äù, ‚Äú4,000‚Äì6,000‚Äù, ‚Ä¶
$ Gender <chr> ‚ÄúFemale‚Äù, ‚ÄúMale‚Äù, ‚Ä¶</chr></chr></chr></p>
<p>You can already you spot issues:</p>
<ul>
<li>
<code>Age</code> is stored as character, not numeric.</li>
<li>Column !!!!! contain spaces and symbols.</li>
<li>There are multiple inconsistent formats for <code>income</code>.</li>
</ul>
<p>Before cleaning, it helps to know what R thinks each type means:</p>
<div id="qhzhjviejg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qhzhjviejg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qhzhjviejg thead, #qhzhjviejg tbody, #qhzhjviejg tfoot, #qhzhjviejg tr, #qhzhjviejg td, #qhzhjviejg th {
  border-style: none;
}

#qhzhjviejg p {
  margin: 0;
  padding: 0;
}

#qhzhjviejg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qhzhjviejg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qhzhjviejg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qhzhjviejg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qhzhjviejg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qhzhjviejg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qhzhjviejg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qhzhjviejg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qhzhjviejg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qhzhjviejg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qhzhjviejg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qhzhjviejg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qhzhjviejg .gt_spanner_row {
  border-bottom-style: hidden;
}

#qhzhjviejg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qhzhjviejg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qhzhjviejg .gt_from_md > :first-child {
  margin-top: 0;
}

#qhzhjviejg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qhzhjviejg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qhzhjviejg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qhzhjviejg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qhzhjviejg .gt_row_group_first td {
  border-top-width: 2px;
}

#qhzhjviejg .gt_row_group_first th {
  border-top-width: 2px;
}

#qhzhjviejg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhzhjviejg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qhzhjviejg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qhzhjviejg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qhzhjviejg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhzhjviejg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qhzhjviejg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qhzhjviejg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qhzhjviejg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qhzhjviejg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qhzhjviejg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhzhjviejg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qhzhjviejg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qhzhjviejg .gt_left {
  text-align: left;
}

#qhzhjviejg .gt_center {
  text-align: center;
}

#qhzhjviejg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qhzhjviejg .gt_font_normal {
  font-weight: normal;
}

#qhzhjviejg .gt_font_bold {
  font-weight: bold;
}

#qhzhjviejg .gt_font_italic {
  font-style: italic;
}

#qhzhjviejg .gt_super {
  font-size: 65%;
}

#qhzhjviejg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qhzhjviejg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qhzhjviejg .gt_indent_1 {
  text-indent: 5px;
}

#qhzhjviejg .gt_indent_2 {
  text-indent: 10px;
}

#qhzhjviejg .gt_indent_3 {
  text-indent: 15px;
}

#qhzhjviejg .gt_indent_4 {
  text-indent: 20px;
}

#qhzhjviejg .gt_indent_5 {
  text-indent: 25px;
}

#qhzhjviejg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qhzhjviejg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div class="inline-table"><table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Overview of R Data Types</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="R-Type">R Type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="What-It-Represents">What It Represents</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Common-Problems">Common Problems</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="R Type" class="gt_row gt_left">character</td>
<td headers="What It Represents" class="gt_row gt_left">text</td>
<td headers="Common Problems" class="gt_row gt_left">numbers read as text</td>
</tr>
<tr>
<td headers="R Type" class="gt_row gt_left">numeric</td>
<td headers="What It Represents" class="gt_row gt_left">decimal numbers</td>
<td headers="Common Problems" class="gt_row gt_left">missing decimals ‚Üí integers</td>
</tr>
<tr>
<td headers="R Type" class="gt_row gt_left">integer</td>
<td headers="What It Represents" class="gt_row gt_left">whole numbers</td>
<td headers="Common Problems" class="gt_row gt_left">rarely a problem</td>
</tr>
<tr>
<td headers="R Type" class="gt_row gt_left">factor</td>
<td headers="What It Represents" class="gt_row gt_left">categorical labels</td>
<td headers="Common Problems" class="gt_row gt_left">wrong order or encoding</td>
</tr>
<tr>
<td headers="R Type" class="gt_row gt_left">logical</td>
<td headers="What It Represents" class="gt_row gt_left">TRUE/FALSE flags</td>
<td headers="Common Problems" class="gt_row gt_left">blanks become NA</td>
</tr>
</tbody>
</table></div>
</div>
<p>Check data types with <code>sapply(finsesco, class)</code> if you‚Äôre unsure.</p>
<div class="callout-tip">
<p>üí° Tip {-}</p>
<p>R‚Äôs type system is strict: <code>"42"</code> (character) is not the same as <code>42</code> (numeric).
Whenever arithmetic fails, first check the variable‚Äôs type.</p>
</div>
</div>
<div id="cleaning-column-names-and-correcting-types" class="section level2 unnumbered">
<h2>3. Cleaning Column Names and Correcting Types<a class="anchor" aria-label="anchor" href="#cleaning-column-names-and-correcting-types"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Why clean names?</strong></p>
<p>Messy names make scripts fragile. Every time you use spaces or special characters, you have to surround the name with backticks, e.g.¬†<code>Income Range (‚Ç¨)</code>.
<code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">janitor::clean_names()</a></code> automatically fixes this by converting all names to lower_snake_case and stripping illegal characters.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">finsesco</span> <span class="op">&lt;-</span> <span class="va">finsesco</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,income_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">income_range</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Step-by-step explanation</strong></p>
<ul>
<li>
<code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names()</a></code> renames columns like <code>Income Range (‚Ç¨)</code> ‚Üí <code>income_range_eur</code>. It also ensures uniqueness‚Äîif two columns share the same label, it appends _2, _3, etc.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> lets us change columns in-place.</li>
<li>
<code>as.integer(age)</code> converts character digits into true numbers.</li>
<li>
<code>as.factor(income_range)</code> tells R this is a categorical variable.</li>
</ul>
<p>Re-inspect:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">finsesco</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 299
## Columns: 34
## $ id                &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,‚Ä¶
## $ income_range      &lt;fct&gt; Low, Low, High, Medium, Low, High, Low, Low, High, Low, High, Medium, ‚Ä¶
## $ co_ownership      &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1‚Ä¶
## $ ownership         &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1‚Ä¶
## $ index_1           &lt;dbl&gt; 4.4, 5.0, 3.4, 5.0, 3.6, 5.0, 5.0, 3.6, 4.2, 3.0, 3.0, 5.0, 5.0, 5.0, ‚Ä¶
## $ index_2           &lt;dbl&gt; 3.571429, 5.000000, 3.714286, 5.000000, 3.000000, 3.857143, NA, 4.1428‚Ä¶
## $ index_3           &lt;dbl&gt; 4, 5, 2, 5, NA, 3, NA, 3, 5, 1, 1, 5, 4, 4, 3, 2, 5, 5, 3, 5, 3, 3, 1,‚Ä¶
## $ index_4           &lt;dbl&gt; 3, 5, 3, 5, NA, 1, NA, 4, 4, 1, 1, 5, 5, 5, 4, 4, 5, NA, 2, 5, 4, 2, 1‚Ä¶
## $ index_5           &lt;dbl&gt; 4, 4, 5, 1, NA, 3, NA, 4, 2, 1, 1, 4, 4, 5, 3, 4, 1, 5, 5, 5, 3, 2, 5,‚Ä¶
## $ index_6           &lt;dbl&gt; 4.333333, 4.666667, 3.000000, 3.000000, NA, 3.666667, NA, 4.666667, 3.‚Ä¶
## $ gender            &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0‚Ä¶
## $ age               &lt;int&gt; 21, 63, 21, 58, 63, 53, 53, 63, 53, 63, 38, 53, 68, 21, 28, 63, 48, 68‚Ä¶
## $ age_factor        &lt;chr&gt; "18-25", "61-65", "18-25", "56-60", "61-65", "51-55", "51-55", "61-65"‚Ä¶
## $ academic          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0‚Ä¶
## $ income_group      &lt;chr&gt; "Low", "Low", "High", "Medium", "Low", "High", "Low", "Low", "High", "‚Ä¶
## $ use_finsesco      &lt;dbl&gt; 1, 4, 2, 1, NA, 1, NA, 1, 1, 1, NA, 1, 1, NA, 1, 1, 1, NA, 1, NA, 1, N‚Ä¶
## $ index_finsesco    &lt;dbl&gt; 0.7299988, 1.1276756, 0.9498817, 0.7299988, NA, 0.7299988, NA, 0.72999‚Ä¶
## $ p_flat            &lt;dbl&gt; 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1‚Ä¶
## $ p_apartment       &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0‚Ä¶
## $ p_house           &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0‚Ä¶
## $ home_ownership    &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1‚Ä¶
## $ finsesco_familiar &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0‚Ä¶
## $ crowd_yes         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0‚Ä¶
## $ crowd_own         &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0‚Ä¶
## $ income_low        &lt;dbl&gt; 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1‚Ä¶
## $ income_med        &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0‚Ä¶
## $ income_high       &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0‚Ä¶
## $ prosumership      &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1‚Ä¶
## $ social_benefit    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0‚Ä¶
## $ control           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1‚Ä¶
## $ interact          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1‚Ä¶
## $ monitor           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1‚Ä¶
## $ income_range_2    &lt;dbl&gt; 1143.789, 1394.153, 4948.919, NA, 1470.234, 5273.978, 1264.053, 1446.2‚Ä¶
## $ income_range_3    &lt;dbl&gt; 1143.789, 1394.153, 4948.919, NA, 1470.234, 5273.978, 1264.053, 1446.2‚Ä¶</code></pre>
<p>If you now see age: int and income_range: fct, the cleaning worked.</p>
<div class="callout-important">
<p>üî¥ Important {-}</p>
<p><code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code> and <code><a href="https://rdrr.io/r/base/integer.html">as.integer()</a></code> silently turn non-convertible text into <code>NA</code>.
Always check how many missing values you introduced: <code>sum(is.na(finsesco$age))</code></p>
</div>
</div>
<div id="the-logic-of-pipes-and-dplyr-verbs" class="section level2 unnumbered">
<h2>4. The Logic of Pipes and dplyr Verbs<a class="anchor" aria-label="anchor" href="#the-logic-of-pipes-and-dplyr-verbs"><i class="fas fa-link"></i></a>
</h2>
<iframe src="https://drive.google.com/file/d/10VChBwFGMXbWcDmAySxzfCqog1hASXli/preview" width="640" height="360" allow="autoplay">
</iframe>
<p>The pipe operator <code>%&gt;%</code> passes the output of one function as the first argument of the next. This creates readable ‚Äúsentences‚Äù of code.</p>
<p>Example without pipes:</p>
<p><code>summarise(group_by(finsesco, income_range),           mean(index_1, na.rm = TRUE))</code></p>
<p>Example with pipes:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">finsesco</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income_range</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean_index_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">index_1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The second version mirrors human thought: take data ‚Üí group ‚Üí summarise.</p>
<div id="eolbyqcexw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eolbyqcexw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eolbyqcexw thead, #eolbyqcexw tbody, #eolbyqcexw tfoot, #eolbyqcexw tr, #eolbyqcexw td, #eolbyqcexw th {
  border-style: none;
}

#eolbyqcexw p {
  margin: 0;
  padding: 0;
}

#eolbyqcexw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eolbyqcexw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eolbyqcexw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eolbyqcexw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eolbyqcexw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eolbyqcexw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eolbyqcexw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eolbyqcexw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eolbyqcexw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eolbyqcexw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eolbyqcexw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eolbyqcexw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eolbyqcexw .gt_spanner_row {
  border-bottom-style: hidden;
}

#eolbyqcexw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eolbyqcexw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eolbyqcexw .gt_from_md > :first-child {
  margin-top: 0;
}

#eolbyqcexw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eolbyqcexw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eolbyqcexw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eolbyqcexw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eolbyqcexw .gt_row_group_first td {
  border-top-width: 2px;
}

#eolbyqcexw .gt_row_group_first th {
  border-top-width: 2px;
}

#eolbyqcexw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eolbyqcexw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eolbyqcexw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eolbyqcexw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eolbyqcexw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eolbyqcexw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eolbyqcexw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eolbyqcexw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eolbyqcexw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eolbyqcexw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eolbyqcexw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eolbyqcexw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eolbyqcexw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eolbyqcexw .gt_left {
  text-align: left;
}

#eolbyqcexw .gt_center {
  text-align: center;
}

#eolbyqcexw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eolbyqcexw .gt_font_normal {
  font-weight: normal;
}

#eolbyqcexw .gt_font_bold {
  font-weight: bold;
}

#eolbyqcexw .gt_font_italic {
  font-style: italic;
}

#eolbyqcexw .gt_super {
  font-size: 65%;
}

#eolbyqcexw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eolbyqcexw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eolbyqcexw .gt_indent_1 {
  text-indent: 5px;
}

#eolbyqcexw .gt_indent_2 {
  text-indent: 10px;
}

#eolbyqcexw .gt_indent_3 {
  text-indent: 15px;
}

#eolbyqcexw .gt_indent_4 {
  text-indent: 20px;
}

#eolbyqcexw .gt_indent_5 {
  text-indent: 25px;
}

#eolbyqcexw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eolbyqcexw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div class="inline-table"><table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>The Five Essential dplyr Verbs</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Verb">Verb</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="What-it-does">What It Does</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Analogy">Analogy</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Verb" class="gt_row gt_left">select()</td>
<td headers="What it does" class="gt_row gt_left">choose columns</td>
<td headers="Analogy" class="gt_row gt_left">decide which questions to keep</td>
</tr>
<tr>
<td headers="Verb" class="gt_row gt_left">filter()</td>
<td headers="What it does" class="gt_row gt_left">choose rows</td>
<td headers="Analogy" class="gt_row gt_left">choose which participants to include</td>
</tr>
<tr>
<td headers="Verb" class="gt_row gt_left">mutate()</td>
<td headers="What it does" class="gt_row gt_left">add/modify columns</td>
<td headers="Analogy" class="gt_row gt_left">compute new variables</td>
</tr>
<tr>
<td headers="Verb" class="gt_row gt_left">arrange()</td>
<td headers="What it does" class="gt_row gt_left">reorder rows</td>
<td headers="Analogy" class="gt_row gt_left">sort by value</td>
</tr>
<tr>
<td headers="Verb" class="gt_row gt_left">summarise() + group_by()</td>
<td headers="What it does" class="gt_row gt_left">aggregate groups</td>
<td headers="Analogy" class="gt_row gt_left">compute averages per category</td>
</tr>
</tbody>
</table></div>
</div>
<p>Let‚Äôs apply them:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mini</span> <span class="op">&lt;-</span> <span class="va">finsesco</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">gender</span>, <span class="va">income_range</span>, <span class="va">index_1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">index_1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>high_invest_intent <span class="op">=</span> <span class="va">index_1</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">index_1</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">index_1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Explanation:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> keeps only relevant variables.</li>
<li>
<code>filter(!is.na(index_1))</code> removes incomplete responses.</li>
<li>
<code>quantile(index_1, 0.75)</code> finds the top 25 % cutoff.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> creates a logical variable (TRUE/FALSE) indicating whether each person is in that top quartile.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> orders the dataset so the highest scores appear first.</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mini</span><span class="op">)</span></span></code></pre></div>
<p>Now you can see the structure: a concise, consistent table for further analysis.</p>
<p>If you want to know all the other verbs from <code>dplyr</code>, you can download a <em>cheat sheet</em>, that serves as a manual for using it.</p>
<p><a href="https://media.datacamp.com/legacy/image/upload/v1660300796/Marketing/Blog/Manipulating_Data_in_dplyr_Cheat_Sheet.pdf">üìÑ Download the <em>dplyr Cheat Sheet</em> (PDF)</a></p>
</div>
<div id="grouping-summarizing-and-interpreting" class="section level2 unnumbered">
<h2>5. Grouping, Summarizing, and Interpreting<a class="anchor" aria-label="anchor" href="#grouping-summarizing-and-interpreting"><i class="fas fa-link"></i></a>
</h2>
<p>Aggregating data is the first step toward understanding patterns.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mini</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income_range</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            mean_index_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">index_1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            sd_index_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">index_1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            share_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">high_invest_intent</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> adds a ‚Äúgrouping‚Äù attribute without changing the data itself.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> collapses each group to one row by computing summary statistics.</li>
<li>Because TRUE = 1 and FALSE = 0, <code>mean(high_invest_intent)</code> automatically yields the proportion of TRUEs.</li>
</ul>
<p>Interpretation example:</p>
<p>Higher-income respondents show higher mean <code>index_1</code> and a larger share of high-intention investors, suggesting economic capacity plays a role in willingness to invest.</p>
<p><strong>Be careful:</strong> these are descriptive patterns, not causal effects!
We haven‚Äôt yet controlled for age, ownership, education or other variables.</p>
</div>
<div id="recoding-and-creating-ordered-factors" class="section level2 unnumbered">
<h2>6. Recoding and Creating Ordered Factors<a class="anchor" aria-label="anchor" href="#recoding-and-creating-ordered-factors"><i class="fas fa-link"></i></a>
</h2>
<p>Categorical variables should have intuitive labels and logical order.</p>
<p>Re-labeling income groups</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">finsesco</span> <span class="op">&lt;-</span> <span class="va">finsesco</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  income_range <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">income_range</span>,</span>
<span>  <span class="st">"Low"</span> <span class="op">=</span> <span class="st">"Under ‚Ç¨1,500"</span>,</span>
<span>  <span class="st">"Middle"</span> <span class="op">=</span> <span class="st">"‚Ç¨1,500‚Äì‚Ç¨4,000"</span>,</span>
<span>  <span class="st">"High"</span> <span class="op">=</span> <span class="st">"Over ‚Ç¨4,000"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="st">"Low"</span>,<span class="st">"Middle"</span>,<span class="st">"High"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode()</a></code> maps old labels to shorter ones.</li>
<li>
<code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> defines the order used in plots and summaries.</li>
<li>Without re-leveling, R might sort alphabetically, putting ‚ÄúMiddle‚Äù before ‚ÄúLow‚Äù.</li>
</ul>
<p>Creating age groups</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">finsesco</span> <span class="op">&lt;-</span> <span class="va">finsesco</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  age_group <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>  <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">30</span> <span class="op">~</span> <span class="st">"18‚Äì29"</span>,</span>
<span>  <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">45</span> <span class="op">~</span> <span class="st">"30‚Äì44"</span>,</span>
<span>  <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">60</span> <span class="op">~</span> <span class="st">"45‚Äì59"</span>,</span>
<span>  <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">60</span> <span class="op">~</span> <span class="st">"60+"</span>,</span>
<span>  <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"18‚Äì29"</span>,<span class="st">"30‚Äì44"</span>,<span class="st">"45‚Äì59"</span>,<span class="st">"60+"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> checks each condition sequentially.</li>
<li>The pipe into <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> turns the string labels into an ordered categorical variable, ensuring that 18‚Äì29 appears before 30‚Äì44 in graphs.</li>
</ul>
<p>Why this matters: statistical models interpret factors based on their order‚Äîby defining it explicitly, you avoid misleading reference levels later.</p>
</div>
<div id="saving-and-versioning-clean-data" class="section level2 unnumbered">
<h2>7. Saving and Versioning Clean Data<a class="anchor" aria-label="anchor" href="#saving-and-versioning-clean-data"><i class="fas fa-link"></i></a>
</h2>
<p>Never overwrite the raw file. Always save a new one that documents its lineage.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean</span> <span class="op">&lt;-</span> <span class="va">finsesco</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">age_group</span>, <span class="va">gender</span>,</span>
<span>  <span class="va">income_range</span>, <span class="va">index_1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">clean</span>, <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"finsesco_clean.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This becomes the baseline for all later sessions.
If you later discover an error, you can regenerate the file from the same script rather than editing data manually.</p>
</div>
<div id="conceptual-reflection" class="section level2 unnumbered">
<h2>8. Conceptual Reflection<a class="anchor" aria-label="anchor" href="#conceptual-reflection"><i class="fas fa-link"></i></a>
</h2>
<p>Cleaning data is not busywork‚Äîit‚Äôs modeling reality.
When you decide that ‚Äúunder ‚Ç¨1,500‚Äù means ‚ÄúLow-Income‚Äù you‚Äôre interpreting social categories. When you replace a missing <code>index_1</code> by the median, you‚Äôre making an assumption about the underlying distribution. Recognizing these choices makes you a transparent analyst.</p>
</div>
<div id="exercise-1" class="section level2 unnumbered">
<h2>Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<strong>Exercise 02</strong>: <strong><a href="exercises/ex02/ex02.Rmd">Download PDF</a></strong><br>
</li>
<li>Upload via <strong>Assignments</strong> page on Moodle.</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="session-1.html">Session 1</a></div>
<div class="next"><a href="session-3.html">Session 3</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#session-2">Session 2</a></li>
<li><a class="nav-link" href="#why-data-cleaning-is-the-hardest-and-most-important-step">1. Why Data Cleaning Is the Hardest (and Most Important) Step</a></li>
<li><a class="nav-link" href="#importing-and-inspecting-the-dataset">2. Importing and Inspecting the Dataset</a></li>
<li><a class="nav-link" href="#cleaning-column-names-and-correcting-types">3. Cleaning Column Names and Correcting Types</a></li>
<li><a class="nav-link" href="#the-logic-of-pipes-and-dplyr-verbs">4. The Logic of Pipes and dplyr Verbs</a></li>
<li><a class="nav-link" href="#grouping-summarizing-and-interpreting">5. Grouping, Summarizing, and Interpreting</a></li>
<li><a class="nav-link" href="#recoding-and-creating-ordered-factors">6. Recoding and Creating Ordered Factors</a></li>
<li><a class="nav-link" href="#saving-and-versioning-clean-data">7. Saving and Versioning Clean Data</a></li>
<li><a class="nav-link" href="#conceptual-reflection">8. Conceptual Reflection</a></li>
<li><a class="nav-link" href="#exercise-1">Exercise</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/USER/REPO/blob/main/03-class-02.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/USER/REPO/edit/main/03-class-02.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Energy-Transitions</strong>" was written by Renan Magalh√£es. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
